Installation Instructions
Check out the instantcommons branch from http://svn.wikimedia.org/viewvc/mediawiki/branches/instantcommons/

README
* How is the implementation done?
This implementation extends the new Mediawiki API to include another action called 'instantcommons'.

*How do I use the functionality?
- Enable the cURL extension on your webserver(and for php too). 
- Install 2 (or more) instances of the downloaded InstantCommons branch of Mediawiki 
NB: If you install both instances on the same machine, you need to disable shared uploads in order to use instantcommons functionality as shared upload functionality has higher priority than InstantCommons functionality on when both Mediawiki instances are on the same machine.

- Edit your LocalSettinngs.php and add the following lines:
//InstantCommons Settings
$wgUseInstantCommons = true; //this activates the IC Api
$wgInstantCommonsServerPath = "http://example.com/commons"; //this points to the full url of the folder which contains the index.php of your mediawiki instance (with no trailing slash!).

- Navigate to your client mediawiki, upload an Image, say A.jpg.
- Navigate to your commons mediawiki, create a page and make a direct reference to A.jpg as if it were a local image.
- Sit back and enjoy. A.jpg should be downloaded and stored locally.


* How do I debug?
- Navigate to $wgInstantCommonsServerPath/api.php and make sure there is action=instantcommons listed.

KNOWN LIMITATIONS
This patch has only been tested on Linux-Apache-MySQL-PHP (with cURL)

TODO
- Integrate LocalSettings.php variables into installation procedure

CHANGELOG
Files changed: 
- includes/Image.php
$fromInstantCommons (added)
$description
- imageUrl()
- thumbUrl()
- getUrl()
- loadFromDB()
- load()
- loadFromFile()

- includes/ImageFunctions.php
- wfGetHashPath()

- includes/api/ApiMain.php
private static $Modules (added "instantcommons" to array)

- includes/AutoLoader.php
static $localClasses (added "ApiInstantCommons" to array)

- includes/api/ApiInstantCommons.php (new file)

- includes/SpecialUpload.php
now distinguishes file upload sources


Known Limitations:
Not included in automatic installation procedure.
No storage of IC variable in Image class in database.
No indication of "downloading" status.


TODO:
Show downloading.png in place of the file if download is not complete. Hack the Image display functionality.
